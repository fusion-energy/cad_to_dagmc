
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Advanced Options &#8212; cad_to_dagmc 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=116144d8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=e1a75a79"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'advanced';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python API Reference" href="api.html" />
    <link rel="prev" title="H5M File Backends" href="h5m_backends.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="cad_to_dagmc 0.1 documentation - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="cad_to_dagmc 0.1 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Input Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="material_tagging.html">Material Tagging</a></li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Output Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="meshing_backends.html">Meshing Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="h5m_backends.html">H5M File Backends</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Advanced Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/fusion-energy/cad_to_dagmc" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/advanced.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Advanced Options</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry-scaling">Geometry Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#per-volume-mesh-sizing">Per-Volume Mesh Sizing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-algorithms">Mesh Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imprinting-control">Imprinting Control</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cad-transfer-method">CAD Transfer Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-complement-material">Implicit Complement Material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-the-gmsh-object">Accessing the GMSH Object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing">Parallel Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limiting-cadquery-threads">Limiting CadQuery Threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limiting-gmsh-threads">Limiting GMSH Threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-limit-threads">When to Limit Threads</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="advanced-options">
<h1>Advanced Options<a class="headerlink" href="#advanced-options" title="Link to this heading">#</a></h1>
<p>This page covers advanced configuration options.</p>
<section id="geometry-scaling">
<h2>Geometry Scaling<a class="headerlink" href="#geometry-scaling" title="Link to this heading">#</a></h2>
<p>Scale geometry using the <code class="docutils literal notranslate"><span class="pre">scale_factor</span></code> parameter. Useful when converting
between units (e.g., mm to cm for neutronics).</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale from mm to cm (divide by 10)</span>
<span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Scale up by 2x</span>
<span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">scale_factor</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="per-volume-mesh-sizing">
<h2>Per-Volume Mesh Sizing<a class="headerlink" href="#per-volume-mesh-sizing" title="Link to this heading">#</a></h2>
<p>Set different mesh sizes for different volumes using <code class="docutils literal notranslate"><span class="pre">set_size</span></code>.</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">min_mesh_size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">max_mesh_size</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">set_size</span><span class="o">=</span><span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>   <span class="c1"># Volume 1: fine mesh (0.5)</span>
        <span class="mi">2</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>   <span class="c1"># Volume 2: coarse mesh (5.0)</span>
        <span class="mi">3</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>   <span class="c1"># Volume 3: medium mesh (1.0)</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">set_size</span></code> only works with the GMSH meshing backend.</p>
</div>
</section>
<section id="mesh-algorithms">
<h2>Mesh Algorithms<a class="headerlink" href="#mesh-algorithms" title="Link to this heading">#</a></h2>
<p>GMSH provides multiple meshing algorithms. Select with <code class="docutils literal notranslate"><span class="pre">mesh_algorithm</span></code>.</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">mesh_algorithm</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>  <span class="c1"># Frontal-Delaunay</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Available algorithms:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>: MeshAdapt (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>: Automatic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code>: Delaunay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code>: Frontal-Delaunay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">7</span></code>: BAMG</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">8</span></code>: Frontal-Delaunay for Quads</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">9</span></code>: Packing of Parallelograms</p></li>
</ul>
<p>See <a class="reference external" href="https://gmsh.info/doc/texinfo/gmsh.html#Mesh-options">GMSH documentation</a>
for details.</p>
</section>
<section id="imprinting-control">
<h2>Imprinting Control<a class="headerlink" href="#imprinting-control" title="Link to this heading">#</a></h2>
<p>Imprinting ensures shared surfaces between adjacent volumes are meshed consistently.
It’s enabled by default but can be disabled for geometries that don’t need it.</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">imprint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Disable imprinting</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Disabling imprinting may cause mesh inconsistencies at volume interfaces.
Only disable if you know your geometry doesn’t require it.</p>
</div>
</section>
<section id="cad-transfer-method">
<h2>CAD Transfer Method<a class="headerlink" href="#cad-transfer-method" title="Link to this heading">#</a></h2>
<p>Control how CAD geometry is transferred to GMSH.</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;file&quot;</span><span class="p">,</span>      <span class="c1"># Write to temp file (default, more compatible)</span>
    <span class="c1"># or</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;inMemory&quot;</span><span class="p">,</span>  <span class="c1"># Direct transfer (faster, requires matching OCC versions)</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>File method (default):</strong></p>
<ul class="simple">
<li><p>More compatible across installations</p></li>
<li><p>Works with pip-installed packages</p></li>
<li><p>Slightly slower due to file I/O</p></li>
</ul>
<p><strong>In-memory method:</strong></p>
<ul class="simple">
<li><p>Faster for large geometries</p></li>
<li><p>Requires matching OpenCASCADE versions between CadQuery and GMSH</p></li>
<li><p>Works reliably with Conda installations</p></li>
</ul>
</section>
<section id="implicit-complement-material">
<h2>Implicit Complement Material<a class="headerlink" href="#implicit-complement-material" title="Link to this heading">#</a></h2>
<p>Set a material tag for DAGMC’s implicit complement (the void space).</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">export_dagmc_h5m_file</span><span class="p">(</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">,</span>
    <span class="n">implicit_complement_material_tag</span><span class="o">=</span><span class="s2">&quot;void&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="accessing-the-gmsh-object">
<h2>Accessing the GMSH Object<a class="headerlink" href="#accessing-the-gmsh-object" title="Link to this heading">#</a></h2>
<p>For advanced mesh control, access the GMSH object directly.</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cad_to_dagmc</span>

<span class="c1"># Initialize GMSH</span>
<span class="n">gmsh_obj</span> <span class="o">=</span> <span class="n">cad_to_dagmc</span><span class="o">.</span><span class="n">init_gmsh</span><span class="p">()</span>

<span class="c1"># ... add geometry and configure mesh ...</span>

<span class="c1"># Set advanced GMSH options</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.OptimizeNetgen&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.Smoothing&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Generate mesh</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Export</span>
<span class="n">cad_to_dagmc</span><span class="o">.</span><span class="n">export_gmsh_object_to_dagmc_h5m_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;dagmc.h5m&quot;</span><span class="p">)</span>

<span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="parallel-processing">
<h2>Parallel Processing<a class="headerlink" href="#parallel-processing" title="Link to this heading">#</a></h2>
<p>Both CadQuery and GMSH use parallel processing for operations like imprinting and meshing.
By default, they use all available CPU cores. On shared servers or when memory is limited,
you may want to restrict the number of threads.</p>
<section id="limiting-cadquery-threads">
<h3>Limiting CadQuery Threads<a class="headerlink" href="#limiting-cadquery-threads" title="Link to this heading">#</a></h3>
<p>CadQuery provides a <code class="docutils literal notranslate"><span class="pre">setThreads</span></code> function to control the number of threads used for
boolean operations and imprinting:</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cadquery.occ_impl.shapes</span><span class="w"> </span><span class="kn">import</span> <span class="n">setThreads</span>

<span class="n">setThreads</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># Limit to 4 threads</span>
</pre></div>
</div>
<p>This can be called at any point before your geometry operations.</p>
<p>Alternatively, you can configure the thread pool before importing CadQuery:</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">OCP</span>
<span class="n">OCP</span><span class="o">.</span><span class="n">OSD</span><span class="o">.</span><span class="n">OSD_ThreadPool</span><span class="o">.</span><span class="n">DefaultPool_s</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># Limit to 4 threads</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cadquery</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cad_to_dagmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">CadToDagmc</span>
</pre></div>
</div>
<p>Or use the <code class="docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code> environment variable:</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">4</span>
python<span class="w"> </span>my_script.py
</pre></div>
</div>
</section>
<section id="limiting-gmsh-threads">
<h3>Limiting GMSH Threads<a class="headerlink" href="#limiting-gmsh-threads" title="Link to this heading">#</a></h3>
<p>GMSH parallelism is controlled through its own options:</p>
<!--pytest-codeblocks:skip-->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cad_to_dagmc</span>

<span class="n">gmsh_obj</span> <span class="o">=</span> <span class="n">cad_to_dagmc</span><span class="o">.</span><span class="n">init_gmsh</span><span class="p">()</span>

<span class="c1"># Limit parallel meshing to 4 threads</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;General.NumThreads&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MaxNumThreads1D&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MaxNumThreads2D&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MaxNumThreads3D&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># ... continue with meshing ...</span>
</pre></div>
</div>
</section>
<section id="when-to-limit-threads">
<h3>When to Limit Threads<a class="headerlink" href="#when-to-limit-threads" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Shared servers</strong>: Avoid monopolizing all cores</p></li>
<li><p><strong>Memory constraints</strong>: Each thread requires memory; fewer threads = lower peak memory</p></li>
<li><p><strong>Debugging</strong>: Single-threaded execution can make errors easier to diagnose</p></li>
</ul>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="h5m_backends.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">H5M File Backends</p>
      </div>
    </a>
    <a class="right-next"
       href="api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Python API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometry-scaling">Geometry Scaling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#per-volume-mesh-sizing">Per-Volume Mesh Sizing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-algorithms">Mesh Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imprinting-control">Imprinting Control</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cad-transfer-method">CAD Transfer Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implicit-complement-material">Implicit Complement Material</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-the-gmsh-object">Accessing the GMSH Object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing">Parallel Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limiting-cadquery-threads">Limiting CadQuery Threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limiting-gmsh-threads">Limiting GMSH Threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-limit-threads">When to Limit Threads</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fusion Energy
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Fusion Energy.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>